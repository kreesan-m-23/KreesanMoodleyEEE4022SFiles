
/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  ** This notice applies to any and all portions of this file
  * that are not between comment pairs USER CODE BEGIN and
  * USER CODE END. Other portions of this file, whether 
  * inserted by the user or by software development tools
  * are owned by their respective copyright owners.
  *
  * COPYRIGHT(c) 2018 STMicroelectronics
  *
  * Redistribution and use in source and binary forms, with or without modification,
  * are permitted provided that the following conditions are met:
  *   1. Redistributions of source code must retain the above copyright notice,
  *      this list of conditions and the following disclaimer.
  *   2. Redistributions in binary form must reproduce the above copyright notice,
  *      this list of conditions and the following disclaimer in the documentation
  *      and/or other materials provided with the distribution.
  *   3. Neither the name of STMicroelectronics nor the names of its contributors
  *      may be used to endorse or promote products derived from this software
  *      without specific prior written permission.
  *
  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
  ******************************************************************************
  */
/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include "stm32f4xx_hal.h"

/* USER CODE BEGIN Includes */

/* USER CODE END Includes */

/* Private variables ---------------------------------------------------------*/
ADC_HandleTypeDef hadc1;

DAC_HandleTypeDef hdac;

TIM_HandleTypeDef htim2;

/* USER CODE BEGIN PV */
/* Private variables ---------------------------------------------------------*/

/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_DAC_Init(void);
static void MX_TIM2_Init(void);
static void MX_ADC1_Init(void);

/* USER CODE BEGIN PFP */
/* Private function prototypes -----------------------------------------------*/

/* USER CODE END PFP */

/* USER CODE BEGIN 0 */
	uint16_t adc_val = 0;
	uint8_t num_pulse = 1;
	uint16_t delay = 0;
	uint16_t once_off_delay = 0;
	uint16_t delay_counter = 0;
	uint16_t pulse_counter = 0;
	uint16_t pulse[4500] = {1775,	
2223,
2622,
2927,
3104,
3132,
3009,
2749,
2380,
1944,
1488,
1065,
720,
494,
410,
478,
691,
1025,
1443,
1898,
2339,
2717,
2990,
3127,
3113,
2949,
2653,
2260,
1812,
1360,
954,
640,
453,
414,
528,
781,
1146,
1581,
2038,
2466,
2816,
3049,
3139,
3076,
2867,
2535,
2117,
1661,
1218,
837,
562,
423,
436,
600,
895,
1290,
1740,
2193,
2600,
2913,
3098,
3134,
3017,
2759,
2391,
1953,
1494,
1068,
721,
493,
410,
481,
698,
1037,
1459,
1917,
2359,
2735,
3002,
3131,
3105,
2930,
2623,
2220,
1767,
1314,
914,
611,
440,
420,
554,
827,
1207,
1651,
2110,
2530,
2865,
3076,
3139,
3047,
2810,
2455,
2023,
1563,
1127,
764,
516,
412,
463,
663,
990,
1406,
1864,
2313,
2700,
2981,
3125,
3114,
2951,
2654,
2256,
1803,
1346,
939,
627,
446,
417,
544,
811,
1188,
1632,
2093,
2518,
2857,
3072,
3139,
3049,
2814,
2459,
2025,
1563,
1125,
762,
514,
411,
465,
669,
1000,
1420,
1881,
2330,
2714,
2991,
3128,
3109,
2937,
2631,
2226,
1769,
1313,
910,
606,
437,
423,
564,
844,
1232,
1683,
2144,
2563,
2890,
3089,
3136,
3026,
2771,
2401,
1959,
1495,
1063,
714,
487,
410,
490,
719,
1070,
1503,
1967,
2409,
2778,
3030,
3137,
3086,
2883,
2551,
2129,
1666,
1215,
830,
554,
420,
443,
621,
933,
1343,
1803,
2260,
2660,
2958,
3118,
3121,
2968,
2676,
2278,
1822,
1361,
947,
630,
447,
418,
547,
820,
1204,
1655,
2120,
2544,
2879,
3085,
3137,
3031,
2777,
2406,
1962,
1495,
1061,
711,
485,
410,
494,
729,
1086,
1524,
1992,
2434,
2798,
3043,
3139,
3075,
2858,
2514,
2083,
1616,
1168,
790,
529,
413,
458,
658,
989,
1412,
1878,
2332,
2720,
2997,
3130,
3104,
2920,
2602,
2186,
1722,
1263,
865,
574,
425,
435,
603,
909,
1318,
1780,
2242,
2649,
2952,
3116,
3122,
2968,
2673,
2272,
1811,
1347,
933,
618,
441,
421,
562,
847,
1241,
1699,
2166,
2586,
2910,
3100,
3132,
3003,
2728,
2340,
1885,
1416,
990,
657,
457,
414,
532,
799,
1181,
1634,
2104,
2535,
2875,
3084,
3137,
3028,
2769,
2392,
1941,
1470,
1036,
689,
472,
411,
512,
764,
1137,
1586,
2058,
2495,
2847,
3071,
3139,
3044,
2797,
2428,
1981,
1509,
1068,
712,
484,
410,
499,
742,
1108,
1554,
2027,
2470,
2829,
3061,
3139,
3054,
2814,
2450,
2004,
1531,
1087,
726,
490,
410,
493,
730,
1094,
1539,
2013,
2458,
2821,
3057,
3139,
3057,
2820,
2457,
2012,
1537,
1092,
729,
492,
410,
492,
730,
1094,
1540,
2015,
2460,
2823,
3059,
3139,
3055,
2815,
2450,
2002,
1527,
1082,
721,
487,
410,
497,
740,
1108,
1557,
2033,
2477,
2836,
3066,
3139,
3047,
2800,
2428,
1977,
1501,
1059,
703,
478,
410,
509,
761,
1137,
1591,
2067,
2507,
2858,
3078,
3138,
3032,
2773,
2392,
1935,
1459,
1022,
676,
464,
413,
527,
794,
1181,
1641,
2116,
2551,
2890,
3093,
3134,
3009,
2733,
2340,
1877,
1402,
972,
641,
448,
418,
555,
841,
1241,
1707,
2182,
2606,
2928,
3109,
3126,
2977,
2680,
2272,
1802,
1329,
911,
599,
432,
430,
593,
902,
1318,
1790,
2261,
2672,
2972,
3125,
3111,
2932,
2611,
2186,
1711,
1243,
841,
554,
418,
449,
644,
979,
1412,
1890,
2354,
2746,
3018,
3136,
3086,
2873,
2525,
2083,
1603,
1145,
764,
509,
410,
481,
712,
1075,
1524,
2005,
2457,
2825,
3062,
3139,
3047,
2797,
2419,
1962,
1481,
1036,
684,
467,
412,
528,
798,
1190,
1655,
2135,
2570,
2906,
3101,
3130,
2991,
2700,
2294,
1822,
1345,
921,
604,
433,
429,
594,
906,
1326,
1803,
2276,
2687,
2983,
3128,
3104,
2914,
2581,
2147,
1666,
1199,
804,
530,
413,
466,
683,
1037,
1484,
1967,
2426,
2803,
3052,
3139,
3056,
2812,
2437,
1979,
1495,
1046,
689,
468,
412,
527,
799,
1194,
1662,
2144,
2580,
2914,
3105,
3128,
2980,
2681,
2267,
1791,
1313,
893,
584,
426,
438,
618,
945,
1376,
1858,
2330,
2731,
3011,
3135,
3087,
2873,
2520,
2072,
1587,
1125,
746,
497,
410,
495,
743,
1122,
1583,
2069,
2518,
2872,
3087,
3135,
3011,
2729,
2327,
1854,
1371,
939,
613,
435,
428,
591,
905,
1330,
1811,
2288,
2700,
2993,
3131,
3097,
2894,
2548,
2104,
1617,
1151,
764,
506,
410,
488,
730,
1106,
1567,
2055,
2507,
2865,
3084,
3136,
3013,
2732,
2329,
1855,
1370,
937,
611,
434,
429,
596,
915,
1343,
1827,
2304,
2713,
3002,
3134,
3091,
2879,
2525,
2075,
1586,
1122,
741,
493,
410,
502,
758,
1144,
1612,
2101,
2548,
2895,
3098,
3131,
2989,
2690,
2274,
1793,
1310,
886,
577,
423,
443,
634,
973,
1416,
1904,
2376,
2771,
3036,
3139,
3065,
2825,
2448,
1985,
1494,
1039,
680,
462,
414,
542,
830,
1240,
1720,
2206,
2637,
2956,
3121,
3113,
2930,
2598,
2158,
1669,
1194,
794,
521,
411,
478,
714,
1087,
1550,
2043,
2500,
2863,
3084,
3135,
3009,
2722,
2312,
1831,
1344,
912,
592,
427,
437,
622,
957,
1399,
1890,
2365,
2764,
3034,
3139,
3066,
2824,
2445,
1978,
1485,
1030,
671,
458,
416,
552,
848,
1266,
1750,
2237,
2664,
2974,
3127,
3103,
2905,
2558,
2109,
1615,
1143,
753,
498,
410,
501,
759,
1151,
1625,
2118,
2567,
2911,
3106,
3126,
2968,
2653,
2222,
1733,
1248,
834,
543,
414,
464,
688,
1054,
1516,
2011,
2476,
2848,
3078,
3137,
3015,
2730,
2319,
1835,
1344,
909,
589,
425,
440,
631,
974,
1422,
1917,
2393,
2788,
3048,
3139,
3050,
2792,
2399,
1923,
1428,
978,
634,
441,
425,
588,
909,
1344,
1837,
2322,
2733,
3018,
3137,
3075,
2841,
2464,
1996,
1498,
1037,
674,
458,
416,
556,
858,
1282,
1771,
2262,
2687,
2991,
3132,
3093,
2877,
2515,
2054,
1555,
1086,
708,
473,
412,
533,
819,
1234,
1721,
2214,
2650,
2968,
3126,
3104,
2904,
2552,
2097,
1598,
1123,
735,
486,
410,
517,
793,
1200,
1684,
2181,
2623,
2951,
3121,
3111,
2921,
2577,
2125,
1626,
1147,
752,
495,
410,
508,
777,
1180,
1663,
2161,
2607,
2941,
3118,
3114,
2930,
2589,
2139,
1640,
1158,
760,
499,
410,
504,
771,
1173,
1656,
2155,
2603,
2939,
3118,
3115,
2931,
2590,
2139,
1639,
1157,
759,
498,
410,
506,
775,
1179,
1664,
2164,
2611,
2944,
3120,
3112,
2924,
2579,
2125,
1623,
1142,
747,
491,
410,
514,
789,
1198,
1686,
2186,
2630,
2957,
3124,
3107,
2908,
2556,
2096,
1593,
1115,
726,
480,
411,
528,
814,
1232,
1723,
2222,
2660,
2977,
3129,
3097,
2884,
2520,
2053,
1549,
1075,
697,
466,
414,
548,
850,
1279,
1775,
2271,
2700,
3001,
3135,
3082,
2850,
2471,
1996,
1490,
1024,
660,
450,
421,
578,
899,
1341,
1842,
2334,
2749,
3030,
3139,
3060,
2804,
2407,
1923,
1418,
962,
618,
433,
433,
618,
961,
1417,
1923,
2407,
2805,
3061,
3139,
3029,
2746,
2329,
1835,
1333,
892,
573,
419,
453,
670,
1039,
1510,
2018,
2492,
2866,
3090,
3132,
2986,
2672,
2234,
1732,
1236,
815,
526,
411,
484,
737,
1133,
1618,
2125,
2584,
2930,
3116,
3115,
2929,
2582,
2123,
1615,
1130,
734,
483,
411,
529,
820,
1245,
1743,
2245,
2682,
2993,
3134,
3085,
2854,
2473,
1994,
1485,
1016,
652,
445,
424,
591,
923,
1375,
1882,
2374,
2782,
3050,
3139,
3038,
2760,
2345,
1849,
1343,
897,
574,
419,
454,
674,
1047,
1523,
2034,
2508,
2880,
3097,
3129,
2970,
2644,
2196,
1688,
1193,
779,
505,
410,
505,
780,
1194,
1689,
2197,
2645,
2971,
3129,
3096,
2877,
2503,
2027,
1515,
1039,
667,
451,
421,
582,
912,
1362,
1871,
2367,
2779,
3049,
3139,
3037,
2757,
2338,
1839,
1331,
886,
566,
417,
460,
689,
1071,
1553,
2066,
2538,
2902,
3107,
3122,
2947,
2606,
2147,
1635,
1143,
740,
484,
411,
531,
828,
1259,
1763,
2269,
2704,
3008,
3137,
3072,
2823,
2424,
1934,
1420,
957,
611,
429,
439,
639,
1001,
1473,
1987,
2472,
2857,
3088,
3132,
2982,
2661,
2212,
1702,
1201,
783,
506,
410,
508,
788,
1208,
1710,
2220,
2667,
2987,
3133,
3085,
2850,
2461,
1973,
1457,
987,
629,
435,
433,
623,
978,
1447,
1963,
2452,
2844,
3083,
3134,
2990,
2672,
2225,
1713,
1210,
788,
508,
410,
507,
787,
1209,
1712,
2224,
2671,
2990,
3134,
3082,
2842,
2449,
1958,
1441,
972,
618,
431,
438,
637,
1000,
1475,
1993,
2480,
2865,
3092,
3130,
2972,
2641,
2185,
1669,
1169,
756,
490,
410,
528,
825,
1260,
1769,
2279,
2716,
3017,
3138,
3062,
2799,
2388,
1888,
1371,
913,
580,
420,
456,
684,
1070,
1558,
2078,
2553,
2916,
3113,
3116,
2924,
2564,
2090,
1570,
1080,
691,
459,
418,
575,
906,
1364,
1882,
2384,
2797,
3061,
3138,
3016,
2714,
2274,
1762,
1251,
816,
522,
410,
497,
771,
1191,
1697,
2213,
2666,
2989,
3134,
3081,
2836,
2436,
1940,
1419,
950,
602,
425,
446,
661,
1040,
1526,
2048,
2530,
2902,
3109,
3119,
2933,
2577,
2103,
1581,
1087,
694,
460,
418,
576,
910,
1371,
1891,
2394,
2806,
3067,
3137,
3007,
2696,
2249,
1732,
1221,
792,
508,
410,
513,
801,
1234,
1746,
2262,
2707,
3014,
3138,
3061,
2794,
2377,
1871,
1350,
892,
565,
416,
467,
712,
1114,
1614,
2137,
2607,
2954,
3126,
3098,
2875,
2488,
1996,
1471,
991,
627,
433,
438,
641,
1012,
1496,
2022,
2511,
2891,
3105,
3122,
2938,
2582,
2106,
1581,
1084,
690,
457,
420,
584,
925,
1393,
1917,
2420,
2828,
3078,
3134,
2988,
2661,
2202,
1680,
1171,
752,
486,
411,
540,
854,
1304,
1825,
2338,
2767,
3048,
3139,
3026,
2726,
2284,
1766,
1248,
810,
516,
410,
508,
795,
1229,
1745,
2265,
2712,
3019,
3139,
3054,
2778,
2352,
1839,
1316,
862,
545,
412,
484,
749,
1168,
1679,
2204,
2664,
2991,
3135,
3075,
2819,
2406,
1899,
1372,
906,
571,
416,
466,
713,
1120,
1625,
2153,
2624,
2967,
3130,
3089,
2850,
2448,
1945,
1417,
942,
592,
421,
455,
687,
1084,
1585,
2115,
2593,
2948,
3125,
3098,
2871,
2478,
1979,
1449,
968,
608,
426,
447,
670,
1060,
1558,
2089,
2572,
2935,
3121,
3104,
2885,
2497,
2000,
1468,
983,
618,
429,
444,
661,
1047,
1544,
2076,
2562,
2928,
3120,
3106,
2890,
2505,
2008,
1475,
989,
621,
430,
443,
659,
1045,
1542,
2075,
2562,
2929,
3120,
3106,
2888,
2501,
2003,
1470,
983,
617,
428,
445,
664,
1054,
1553,
2087,
2573,
2936,
3122,
3102,
2879,
2486,
1985,
1451,
967,
607,
425,
450,
678,
1074,
1578,
2111,
2594,
2950,
3126,
3095,
2861,
2461,
1954,
1421,
941,
590,
420,
459,
700,
1106,
1615,
2148,
2625,
2970,
3131,
3084,
2835,
2423,
1911,
1378,
905,
567,
415,
472,
730,
1150,
1665,
2197,
2665,
2995,
3136,
3068,
2799,
2373,
1854,
1323,
861,
541,
411,
492,
771,
1206,
1728,
2258,
2713,
3023,
3139,
3044,
2753,
2310,
1784,
1256,
809,
511,
410,
519,
824,
1276,
1805,
2330,
2768,
3053,
3139,
3013,
2694,
2233,
1701,
1180,
751,
482,
413,
556,
889,
1359,
1894,
2411,
2828,
3082,
3132,
2970,
2623,
2143,
1605,
1094,
689,
453,
424,
604,
968,
1457,
1996,
2501,
2892,
3108,
3117,
2915,
2536,
2037,
1498,
1001,
626,
430,
444,
667,
1063,
1570,
2109,
2596,
2955,
3128,
3090,
2845,
2433,
1917,
1379,
903,
564,
414,
478,
745,
1174,
1697,
2232,
2696,
3015,
3139,
3049,
2758,
2313,
1783,
1252,
803,
507,
410,
528,
842,
1302,
1838,
2363,
2796,
3068,
3136,
2990,
2652,
2176,
1636,
1119,
704,
459,
421,
597,
958,
1449,
1991,
2498,
2892,
3109,
3115,
2910,
2525,
2021,
1478,
982,
612,
425,
452,
688,
1096,
1612,
2153,
2635,
2980,
3134,
3073,
2806,
2376,
1850,
1312,
847,
530,
410,
506,
804,
1256,
1790,
2322,
2767,
3054,
3138,
3005,
2677,
2205,
1664,
1141,
719,
465,
419,
589,
947,
1438,
1982,
2493,
2890,
3109,
3115,
2908,
2520,
2013,
1468,
972,
604,
423,
457,
701,
1117,
1638,
2181,
2659,
2996,
3137,
3061,
2779,
2336,
1804,
1267,
811,
509,
410,
529,
848,
1315,
1855,
2383,
2814,
3078,
3133,
2970,
2616,
2126,
1581,
1066,
665,
442,
433,
639,
1028,
1536,
2083,
2580,
2948,
3128,
3089,
2840,
2419,
1894,
1350,
875,
544,
411,
497,
790,
1240,
1777,
2314,
2763,
3054,
3138,
3002,
2669,
2191,
1646,
1121,
702,
456,
423,
608,
981,
1483,
2031,
2538,
2922,
3120,
3101,
2867,
2457,
1936,
1389,
904,
560,
413,
486,
767,
1212,
1748,
2288,
2745,
3045,
3139,
3012,
2684,
2208,
1662,
1135,
711,
460,
422,
603,
975,
1477,
2027,
2536,
2922,
3121,
3101,
2865,
2452,
1929,
1381,
896,
555,
412,
491,
778,
1229,
1768,
2308,
2761,
3054,
3138,
3000,
2662,
2179,
1630,
1105,
689,
450,
427,
625,
1009,
1519,
2071,
2574,
2947,
3128,
3088,
2833,
2405,
1874,
1326,
852,
529,
410,
514,
824,
1290,
1836,
2371,
2809,
3077,
3132,
2964,
2601,
2103,
1550,
1035,
640,
432,
444,
675,
1086,
1610,
2162,
2649,
2993,
3137,
3057,
2766,
2312,
1769,
1227,
776,
488,
413,
561,
909,
1400,
1953,
2476,
2884,
3108,
3114,
2898,
2497,
1977,
1423,
928,
572,
414,
481,
762,
1210,
1751,
2296,
2755,
3052,
3138,
2998,
2657,
2169,
1616,
1089,
676,
444,
433,
643,
1041,
1561,
2116,
2614,
2973,
3134,
3070,
2790,
2343,
1801,
1254,
794,
497,
411,
552,
896,
1386,
1940,
2467,
2879,
3107,
3114,
2898,
2496,
1973,
1418,
921,
567,
413,
486,
774,
1228,
1773,
2319,
2773,
3062,
3136,
2983,
2629,
2132,
1575,
1052,
649,
434,
443,
674,
1088,
1618,
2173,
2662,
3003,
3138,
3046,
2741,
2275,
1724,
1183,
740,
470,
418,
594,
967,
1475,
2034,
2549,
2934,
3126,
3090,
2835,
2401,
1863,
1309,
834,
516,
410,
532,
863,
1347,
1903,
2437,
2860,
3101,
3119,
2911,
2512,
1989,
1430,
929,
570,
413,
486,
776,
1233,
1782,
2330,
2784,
3068,
3134,
2971,
2607,
2102,
1542,
1021,
627,
427,
454,
703,
1134,
1673,
2229,
2708,
3030,
3139,
3019,
2687,
2202,
1644,
1108,
685,
446,
432,
645,
1049,
1575,
2136,
2635,
2989,
3137,
3054,
2755,
2289,
1736,
1189,
742,
470,
419,
598,
976,
1490,
2053,
2568,
2948,
3130,
3081,
2810,
2363,
1816,
1262,
795,
495,
412,
561,
916,
1417,
1980,
2507,
2910,
3119,
3100,
2854,
2425,
1885,
1326,
844,
520,
410,
532,
867,
1356,
1917,
2454,
2874,
3107,
3113,
2890,
2476,
1942,
1380,
885,
542,
410,
511,
828,
1307,
1866,
2409,
2844,
3096,
3121,
2916,
2516,
1988,
1424,
920,
562,
412,
496,
799,
1269,
1826,
2374,
2820,
3086,
3127,
2936,
2545,
2022,
1457,
946,
577,
414,
485,
778,
1242,
1797,
2349,
2802,
3078,
3130,
2949,
2565,
2045,
1479,
963,
587,
416,
479,
765,
1225,
1780,
2334,
2792,
3074,
3132,
2955,
2575,
2057,
1489,
971,
592,
417,
476,
760,
1219,
1775,
2330,
2789,
3073,
3132,
2956,
2576,
2057,
1489,
971,
591,
417,
477,
763,
1224,
1780,
2336,
2794,
3075,
3131,
2952,
2568,
2046,
1478,
960,
585,
415,
482,
774,
1239,
1797,
2352,
2806,
3081,
3129,
2941,
2550,
2024,
1455,
941,
573,
413,
491,
792,
1265,
1826,
2378,
2826,
3090,
3124,
2924,
2522,
1991,
1421,
913,
556,
411,
504,
819,
1301,
1866,
2415,
2852,
3100,
3117,
2899,
2485,
1946,
1377,
878,
535,
410,
523,
856,
1349,
1917,
2460,
2883,
3112,
3106,
2867,
2436,
1889,
1322,
834,
512,
410,
548,
902,
1409,
1980,
2515,
2920,
3124,
3090,
2826,
2377,
1821,
1258,
785,
486,
414,
582,
959,
1480,
2053,
2577,
2959,
3133,
3068,
2774,
2305,
1742,
1184,
731,
462,
424,
625,
1028,
1563,
2136,
2645,
3000,
3139,
3036,
2711,
2220,
1651,
1103,
674,
439,
441,
678,
1110,
1659,
2229,
2718,
3040,
3138,
2995,
2635,
2123,
1549,
1015,
615,
421,
467,
745,
1206,
1767,
2330,
2794,
3077,
3129,
2941,
2545,
2013,
1438,
922,
559,
411,
506,
826,
1315,
1886,
2437,
2870,
3108,
3109,
2872,
2440,
1889,
1318,
828,
506,
411,
559,
923,
1440,
2016,
2549,
2944,
3130,
3075,
2787,
2319,
1753,
1191,
733,
462,
425,
629,
1038,
1578,
2154,
2662,
3011,
3139,
3023,
2684,
2181,
1606,
1061,
643,
429,
455,
718,
1170,
1730,
2299,
2773,
3069,
3132,
2952,
2560,
2028,
1450,
930,
562,
411,
506,
828,
1320,
1895,
2447,
2879,
3112,
3105,
2858,
2417,
1860,
1287,
802,
493,
414,
580,
961,
1489,
2068,
2595,
2973,
3136,
3053,
2740,
2252,
1679,
1122,
683,
441,
440,
680,
1117,
1673,
2248,
2737,
3052,
3136,
2975,
2596,
2069,
1488,
959,
578,
413,
495,
808,
1296,
1871,
2428,
2867,
3108,
3108,
2866,
2426,
1868,
1293,
805,
493,
414,
581,
965,
1496,
2078,
2604,
2980,
3137,
3047,
2725,
2231,
1653,
1098,
666,
435,
448,
702,
1151,
1714,
2288,
2768,
3068,
3132,
2949,
2552,
2013,
1431,
911,
549,
410,
520,
858,
1364,
1945,
2494,
2913,
3123,
3088,
2812,
2347,
1778,
1207,
741,
463,
425,
633,
1051,
1600,
2182,
2689,
3029,
3139,
3000,
2636,
2115,
1531,
992,
596,
416,
485,
790,
1276,
1853,
2416,
2861,
3107,
3109,
2865,
2422,
1859,
1281,
794,
486,
416,
594,
990,
1530,
2115,
2637,
3001,
3139,
3027,
2684,
2173,
1590,
1040,
625,
422,
468,
755,
1229,
1804,
2373,
2833,
3097,
3117,
2890,
2457,
1898,
1317,
819,
498,
413,
579,
965,
1502,
2088,
2617,
2990,
3138,
3035,
2698,
2191,
1606,
1053,
633,
424,
465,
749,
1222,
1797,
2369,
2830,
3096,
3117,
2889,
2455,
1894,
1312,
814,
495,
414,
584,
976,
1515,
2103,
2630,
2998,
3139,
3026,
2681,
2168,
1581,
1030,
617,
420,
475,
771,
1254,
1834,
2403,
2855,
3106,
3109,
2864,
2416,
1848,
1267,
780,
479,
419,
612,
1021,
1571,
2160,
2676,
3024,
3139,
2999,
2631,
2103,
1513,
972,
581,
413,
499,
824,
1326,
1912,
2473,
2903,
3122,
3089,
2810,
2337,
1759,
1184,
719,
452,
433,
665,
1105,
1670,
2255,
2750,
3062,
3133,
2949,
2544,
1995,
1405,
884,
530,
410,
546,
913,
1441,
2033,
2576,
2968,
3136,
3048,
2721,
2215,
1627,
1066,
639,
425,
465,
752,
1231,
1813,
2387,
2846,
3103,
3110,
2865,
2415,
1843,
1259,
772,
474,
421,
624,
1044,
1601,
2192,
2704,
3040,
3137,
2977,
2590,
2048,
1455,
922,
550,
410,
528,
881,
1404,
1997,
2548,
2952,
3134,
3058,
2739,
2238,
1648,
1083,
648,
427,
462,
745,
1224,
1807,
2384,
2845,
3104,
3110,
2862,
2408,
1834,
1248,
763,
469,
423,
635,
1063,
1626,
2217,
2725,
3051,
3135,
2960,
2559,
2009,
1414,
888,
530,
410,
549,
922,
1457,
2053,
2596,
2982,
3138,
3034,
2690,
2171,
1576,
1019,
607,
417,
486,
802,
1303,
1894,
2463,
2900,
3122,
3086,
2800,
2317,
1731,
1153,
694,
441,
444,
701,
1164,
1744,
2330,
2809,
3090,
3119,
2891,
2448,
1876,
1285,
788,
479,
419,
620,
1041,
1604,
2199,
2713,
3047,
3136,
2964,
2563,
2011,
1413,
885,
527,
410,
555,
934,
1475,
2074,
2615,
2995,
3139,
3021,
2663,
2133,
1535,
983,
583,
413,
505,
842,
1359,
1956,
2518,
2937,
3131,
3064,
2748,
2244,
1649,
1078,
642,
425,
468,
764,
1255,
1847,
2424,
2876,
3115,
3095,
2819,
2341,
1754,
1170,
703,
444,
442,
698,
1163,
1747,
2335,
2815,
3094,
3116,
2879,
2427,
1849,
1256,
764,
468,
425,
645,
1084,
1657,
2253,
2756,
3068,
3130,
2927,
2501,
1933,
1335,
822,
494,
415,
601,
1015,
1577,
2178,
2700,
3042,
3137,
2967,
2564,
2008,
1406,
876,
521,
410,
566,
957,
1508,
2111,
2648,
3015,
3139,
2998,
2617,
2072,
1468,
925,
547,
410,
539,
909,
1449,
2053,
2602,
2989,
3139,
3022,
2660,
2125,
1522,
968,
571,
411,
518,
871,
1401,
2004,
2563,
2967,
3137,
3040,
2695,
2169,
1566,
1003,
592,
414,
502,
840,
1362,
1965,
2531,
2948,
3134,
3053,
2721,
2202,
1600,
1031,
609,
416,
491,
818,
1333,
1936,
2506,
2933,
3131,
3062,
2739,
2226,
1624,
1052,
622,
419,
484,
803,
1314,
1916,
2490,
2923,
3129,
3068,
2751,
2241,
1639,
1063,
629,
420,
480,
795,
1304,
1907,
2483,
2919,
3128,
3070,
2755,
2246,
1643,
1067,
630,
421,
479,
794,
1304,
1907,
2484,
2920,
3129,
3069,
2752,
2242,
1638,
1062,
627,
420,
482,
801,
1313,
1917,
2493,
2926,
3130,
3065,
2743,
2228,
1623,
1048,
618,
418,
488,
814,
1331,
1937,
2511,
2938,
3133,
3057,
2726,
2205,
1598,
1026,
604,
415,
497,
835,
1359,
1967,
2537,
2954,
3135,
3045,
2701,
2172,
1563,
997,
586,
412,
511,
863,
1397,
2007,
2570,
2974,
3138,
3029,
2669,
2129,
1519,
959,
563,
410,
530,
900,
1445,
2056,
2611,
2998,
3139,
3007,
2627,
2076,
1465,
915,
538,
410,
555,
946,
1503,
2115,
2658,
3024,
3139,
2979,
2577,
2013,
1402,
865,
512,
412,
587,
1001,
1571,
2182,
2711,
3051,
3134,
2943,
2516,
1940,
1330,
810,
485,
419,
627,
1067,
1650,
2258,
2768,
3078,
3124,
2898,
2445,
1856,
1251,
751,
459,
432,
677,
1144,
1739,
2341,
2828,
3102,
3107,
2843,
2362,
1762,
1164,
691,
437,
454,
738,
1233,
1838,
2430,
2889,
3122,
3081,
2776,
2267,
1658,
1073,
630,
420,
485,
812,
1334,
1947,
2524,
2949,
3135,
3045,
2696,
2159,
1545,
977,
571,
410,
528,
899,
1448,
2064,
2621,
3006,
3139,
2995,
2602,
2039,
1423,
879,
517,
412,
584,
1000,
1574,
2189,
2719,
3056,
3132,
2930,
2492,
1908,
1296,
782,
471,
426,
657,
1117,
1712,
2319,
2815,
3098,
3110,
2849,
2367,
1764,
1164,
688,
435,
456,
748,
1250,
1860,
2452,
2905,
3127,
3070,
2748,
2226,
1612,
1030,
602,
414,
506,
858,
1399,
2017,
2585,
2987,
3139,
3011,
2628,
2070,
1451,
898,
526,
411,
576,
988,
1562,
2180,
2715,
3055,
3132,
2929,
2488,
1900,
1286,
773,
466,
429,
670,
1139,
1739,
2346,
2836,
3106,
3101,
2823,
2327,
1718,
1120,
657,
425,
473,
789,
1310,
1926,
2511,
2944,
3135,
3044,
2690,
2147,
1527,
957,
557,
410,
545,
935,
1499,
2120,
2670,
3034,
3137,
2957,
2532,
1950,
1331,
804,
479,
423,
647,
1106,
1703,
2316,
2816,
3099,
3108,
2839,
2348,
1739,
1136,
667,
428,
469,
782,
1302,
1920,
2508,
2943,
3135,
3043,
2687,
2141,
1518,
949,
552,
410,
552,
949,
1519,
2142,
2688,
3044,
3135,
2941,
2504,
1915,
1296,
777,
467,
429,
674,
1148,
1753,
2363,
2850,
3112,
3094,
2800,
2291,
1674,
1078,
628,
418,
492,
835,
1375,
1998,
2575,
2984,
3139,
3009,
2619,
2052,
1427,
875,
512,
413,
601,
1035,
1624,
2245,
2767,
3081,
3120,
2877,
2401,
1794,
1183,
696,
436,
457,
756,
1269,
1888,
2484,
2930,
3133,
3050,
2698,
2151,
1526,
952,
552,
410,
555,
957,
1532,
2158,
2703,
3053,
3132,
2925,
2475,
1877,
1257,
747,
454,
439,
707,
1200,
1815,
2421,
2891,
3124,
3072,
2746,
2214,
1589,
1003,
580,
411,
530,
912,
1478,
2106,
2664,
3034,
3136,
2950,
2515,
1923,
1299,
776,
465,
431,
683,
1166,
1779,
2390,
2871,
3119,
3082,
2766,
2240,
1615,
1024,
592,
412,
521,
897,
1460,
2089,
2652,
3028,
3137,
2956,
2524,
1932,
1306,
780,
466,
431,
682,
1166,
1779,
2392,
2873,
3120,
3080,
2761,
2232,
1605,
1014,
586,
411,
528,
910,
1478,
2109,
2668,
3037,
3136,
2943,
2501,
1904,
1279,
759,
457,
437,
703,
1198,
1817,
2427,
2897,
3126,
3066,
2730,
2188,
1558,
974,
562,
410,
550,
953,
1532,
2164,
2711,
3058,
3130,
2910,
2447,
1839,
1217,
715,
441,
453,
749,
1266,
1892,
2493,
2939,
3135,
3038,
2670,
2108,
1475,
906,
524,
412,
592,
1028,
1624,
2253,
2778,
3088,
3114,
2852,
2357,
1737,
1124,
652,
422,
484,
824,
1370,
2003,
2586,
2995,
3139,
2989,
2577,
1991,
1358,
815,
480,
424,
661,
1138,
1753,
2373,
2863,
3118,
3082,
2763,
2229,
1598,
1004,
578,
410,
538,
935,
1513,
2148,
2702,
3055,
3130,
2911,
2446,
1835,
1210,
708,
438,
458,
763,
1289,
1920,
2519,
2957,
3138,
3022,
2635,
2061,
1425,
864,
502,
416,
626,
1086,
1696,
2323,
2830,
3108,
3095,
2795,
2272,
1641,
1039,
597,
412,
524,
909,
1483,
2120,
2682,
3046,
3133,
2923,
2462,
1851,
1224,
716,
440,
455,
759,
1284,
1917,
2519,
2958,
3138,
3020,
2629,
2052,
1414,
854,
496,
418,
637,
1105,
1720,
2346,
2848,
3114,
3087,
2772,
2238,
1603,
1005,
576,
410,
543,
947,
1532,
2170,
2722,
3066,
3126,
2889,
2407,
1787,
1163,
674,
427,
476,
810,
1357,
1995,
2585,
2997,
3139,
2982,
2558,
1962,
1325,
786,
466,
433,
696,
1197,
1825,
2442,
2912,
3131,
3051,
2689,
2126,
1485,
908,
522,
412,
604,
1053,
1662,
2296,
2815,
3104,
3099,
2801,
2277,
1641,
1035,
592,
411,
531,
927,
1510,
2151,
2710,
3061,
3127,
2894,
2413,
1790,
1164,
673,
426,
478,
817,
1369,
2010,
2599,
3006,
3139,
2969,
2535,
1931,
1293,
761,
455,
442,
724,
1240,
1875,
2488,
2942,
3136,
3028,
2641,
2062,
1418,
854,
494,
420,
647,
1125,
1747,
2376,
2871,
3122,
3072,
2734,
2181,
1538,
948,
541,
410,
583,
1022,
1629,
2268,
2797,
3098,
3104,
2812,
2290,
1652,
1041,
594,
411,
533,
932,
1519,
2164,
2722,
3067,
3124,
2879,
2387,
1757,
1132,
650,
420,
493,
854,
1420,
2066,
2647,
3032,
3135,
2934,
2472,
1855,
1219,
707,
435,
464,
786,
1331,
1975,
2574,
2993,
3139,
2979,
2548,
1943,
1300,
764,
455,
442,
729,
1252,
1891,
2505,
2954,
3138,
3015,
2613,
2022,
1375,
819,
477,
428,
682,
1182,
1816,
2440,
2915,
3132,
3044,
2669,
2092,
1444,
870,
500,
418,
642,
1122,
1749,
2382,
2878,
3124,
3066,
2716,
2153,
1504,
917,
523,
413,
610,
1071,
1691,
2330,
2843,
3115,
3083,
2755,
2205,
1557,
959,
545,
410,
584,
1028,
1641,
2285,
2812,
3105,
3095,
2787,
2248,
1602,
995,
565,
410,
564,
993,
1600,
2247,
2786,
3095,
3105,
2812,
2283,
1638,
1025,
582,
410,
549,
966,
1568,
2217,
2765,
3087,
3111,
2830,
2309,
1666,
1048,
595,
411,
538,
947,
1544,
2195,
2749,
3081,
3115,
2843,
2327,
1685,
1063,
604,
412,
531,
934,
1529,
2181,
2739,
3077,
3118,
2851,
2338,
1696,
1072,
609,
412,
528,
928,
1523,
2175,
2735,
3076,
3118,
2853,
2340,
1698,
1073,
609,
412,
528,
929,
1524,
2177,
2737,
3077,
3117,
2850,
2335,
1692,
1067,
605,
412,
531,
937,
1535,
2188,
2746,
3081,
3115,
2841,
2322,
1677,
1054,
597,
411,
539,
951,
1553,
2206,
2760,
3087,
3111,
2827,
2301,
1653,
1033,
585,
410,
550,
973,
1581,
2233,
2780,
3094,
3104,
2807,
2272,
1621,
1006,
568,
410,
566,
1002,
1616,
2268,
2805,
3104,
3095,
2781,
2234,
1581,
972,
549,
410,
587,
1039,
1661,
2310,
2834,
3113,
3082,
2748,
2188,
1532,
932,
528,
413,
613,
1084,
1714,
2359,
2868,
3123,
3065,
2707,
2133,
1475,
887,
505,
418,
646,
1137,
1776,
2415,
2905,
3131,
3043,
2659,
2069,
1411,
837,
482,
427,
687,
1200,
1847,
2477,
2943,
3137,
3014,
2601,
1996,
1339,
783,
459,
442,
735,
1272,
1925,
2544,
2983,
3139,
2977,
2534,
1914,
1260,
727,
439,
463,
793,
1354,
2012,
2615,
3022,
3136,
2932,
2457,
1822,
1176,
670,
423,
492,
862,
1445,
2106,
2689,
3058,
3126,
2877,
2369,
1722,
1087,
613,
412,
531,
941,
1547,
2207,
2765,
3090,
3107,
2810,
2270,
1613,
995,
559,
410,
581,
1033,
1659,
2313,
2840,
3116,
3077,
2731,
2159,
1498,
901,
510,
417,
644,
1137,
1781,
2423,
2912,
3133,
3034,
2638,
2038,
1375,
807,
468,
436,
721,
1254,
1910,
2535,
2979,
3139,
2977,
2530,
1905,
1249,
717,
435,
470,
813,
1384,
2047,
2646,
3039,
3132,
2904,
2408,
1763,
1120,
632,
415,
520,
922,
1526,
2190,
2755,
3087,
3108,
2813,
2272,
1612,
991,
556,
410,
588,
1048,
1680,
2335,
2857,
3121,
3066,
2704,
2121,
1455,
865,
492,
423,
676,
1191,
1844,
2480,
2949,
3138,
3003,
2575,
1956,
1294,
747,
444,
458,
786,
1350,
2015,
2622,
3028,
3134,
2917,
2426,
1780,
1133,
639,
416,
517,
918,
1524,
2190,
2757,
3089,
3107,
2806,
2259,
1596,
976,
546,
411,
601,
1072,
1712,
2366,
2879,
3127,
3052,
2671,
2075,
1407,
827,
474,
433,
713,
1248,
1909,
2538,
2984,
3139,
2968,
2510,
1876,
1217,
692,
427,
485,
853,
1443,
2112,
2700,
3065,
3121,
2853,
2326,
1666,
1032,
577,
410,
571,
1021,
1653,
2314,
2846,
3119,
3069,
2707,
2120,
1450,
859,
487,
426,
690,
1215,
1875,
2511,
2969,
3139,
2980,
2530,
1898,
1235,
703,
430,
481,
844,
1432,
2103,
2695,
3064,
3122,
2854,
2325,
1663,
1028,
573,
410,
576,
1032,
1668,
2330,
2857,
3123,
3062,
2689,
2095,
1423,
836,
477,
432,
712,
1250,
1915,
2546,
2990,
3139,
2957,
2488,
1846,
1187,
670,
421,
501,
890,
1494,
2166,
2743,
3085,
3108,
2808,
2256,
1587,
963,
537,
412,
618,
1106,
1756,
2411,
2911,
3134,
3027,
2614,
1997,
1326,
764,
448,
455,
784,
1355,
2027,
2638,
3039,
3131,
2892,
2381,
1722,
1075,
599,
410,
554,
996,
1629,
2296,
2837,
3118,
3070,
2706,
2115,
1440,
847,
480,
431,
710,
1249,
1917,
2550,
2994,
3139,
2950,
2473,
1825,
1165,
654,
417,
513,
919,
1534,
2208,
2776,
3098,
3096,
2770,
2199,
1525,
911,
510,
419,
660,
1176,
1838,
2485,
2957,
3139,
2986,
2535,
1897,
1229,
695,
426,
489,
869,
1471,
2148,
2733,
3082,
3110,
2808,
2253,
1579,
954,
530,
414,
632,
1132,
1790,
2445,
2934,
3138,
3005,
2569,
1936,
1264,
718,
432,
478,
844,
1439,
2118,
2711,
3073,
3115,
2825,
2276,
1603,
972,
539,
412,
622,
1117,
};
/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  *
  * @retval None
  */
int main(void)
{
  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration----------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_DAC_Init();
  MX_TIM2_Init();
  MX_ADC1_Init();
  /* USER CODE BEGIN 2 */
	HAL_TIM_Base_Start(&htim2);
	HAL_ADC_Start_IT(&hadc1);
	HAL_DAC_Start(&hdac, DAC_CHANNEL_2);
  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {

  /* USER CODE END WHILE */

  /* USER CODE BEGIN 3 */

  }
  /* USER CODE END 3 */

}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{

  RCC_OscInitTypeDef RCC_OscInitStruct;
  RCC_ClkInitTypeDef RCC_ClkInitStruct;

    /**Configure the main internal regulator output voltage 
    */
  __HAL_RCC_PWR_CLK_ENABLE();

  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

    /**Initializes the CPU, AHB and APB busses clocks 
    */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;
  RCC_OscInitStruct.HSEState = RCC_HSE_ON;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 336;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 7;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Initializes the CPU, AHB and APB busses clocks 
    */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV8;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV8;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Configure the Systick interrupt time 
    */
  HAL_SYSTICK_Config(HAL_RCC_GetHCLKFreq()/1000);

    /**Configure the Systick 
    */
  HAL_SYSTICK_CLKSourceConfig(SYSTICK_CLKSOURCE_HCLK);

  /* SysTick_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(SysTick_IRQn, 0, 0);
}

/* ADC1 init function */
static void MX_ADC1_Init(void)
{

  ADC_ChannelConfTypeDef sConfig;

    /**Configure the global features of the ADC (Clock, Resolution, Data Alignment and number of conversion) 
    */
  hadc1.Instance = ADC1;
  hadc1.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV2;
  hadc1.Init.Resolution = ADC_RESOLUTION_12B;
  hadc1.Init.ScanConvMode = DISABLE;
  hadc1.Init.ContinuousConvMode = DISABLE;
  hadc1.Init.DiscontinuousConvMode = DISABLE;
  hadc1.Init.ExternalTrigConvEdge = ADC_EXTERNALTRIGCONVEDGE_RISING;
  hadc1.Init.ExternalTrigConv = ADC_EXTERNALTRIGCONV_T2_TRGO;
  hadc1.Init.DataAlign = ADC_DATAALIGN_RIGHT;
  hadc1.Init.NbrOfConversion = 1;
  hadc1.Init.DMAContinuousRequests = DISABLE;
  hadc1.Init.EOCSelection = ADC_EOC_SINGLE_CONV;
  if (HAL_ADC_Init(&hadc1) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time. 
    */
  sConfig.Channel = ADC_CHANNEL_1;
  sConfig.Rank = 1;
  sConfig.SamplingTime = ADC_SAMPLETIME_3CYCLES;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/* DAC init function */
static void MX_DAC_Init(void)
{

  DAC_ChannelConfTypeDef sConfig;

    /**DAC Initialization 
    */
  hdac.Instance = DAC;
  if (HAL_DAC_Init(&hdac) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

    /**DAC channel OUT2 config 
    */
  sConfig.DAC_Trigger = DAC_TRIGGER_NONE;
  sConfig.DAC_OutputBuffer = DAC_OUTPUTBUFFER_ENABLE;
  if (HAL_DAC_ConfigChannel(&hdac, &sConfig, DAC_CHANNEL_2) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/* TIM2 init function */
static void MX_TIM2_Init(void)
{

  TIM_ClockConfigTypeDef sClockSourceConfig;
  TIM_MasterConfigTypeDef sMasterConfig;

  htim2.Instance = TIM2;
  htim2.Init.Prescaler = 19;
  htim2.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim2.Init.Period = 13;
  htim2.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  if (HAL_TIM_Base_Init(&htim2) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

  sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
  if (HAL_TIM_ConfigClockSource(&htim2, &sClockSourceConfig) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

  sMasterConfig.MasterOutputTrigger = TIM_TRGO_UPDATE;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim2, &sMasterConfig) != HAL_OK)
  {
    _Error_Handler(__FILE__, __LINE__);
  }

}

/** Configure pins as 
        * Analog 
        * Input 
        * Output
        * EVENT_OUT
        * EXTI
*/
static void MX_GPIO_Init(void)
{

  GPIO_InitTypeDef GPIO_InitStruct;

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOH_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12|GPIO_PIN_13, GPIO_PIN_RESET);

  /*Configure GPIO pins : PD12 PD13 */
  GPIO_InitStruct.Pin = GPIO_PIN_12|GPIO_PIN_13;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

}

/* USER CODE BEGIN 4 */
void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc)
{
  /* Prevent unused argument(s) compilation warning */
  UNUSED(hadc);
  /* NOTE : This function Should not be modified, when the callback is needed,
            the HAL_ADC_ConvCpltCallback could be implemented in the user file
   */
	
	HAL_GPIO_TogglePin(GPIOD, GPIO_PIN_13);
	
	if (adc_val > 3000){
		HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12, 1);
		
		delay = (int)(150000*(0.03-(0.000030* 1))); // 0.000005 = 2.5 0.000012 = 5 0.000030 = 10
		if (once_off_delay == (int)((3.3+4)*909)){
			if (delay_counter == delay){
				HAL_DAC_SetValue(&hdac, DAC_CHANNEL_2, DAC_ALIGN_12B_R, pulse[pulse_counter]);
				pulse_counter ++;
				if (pulse_counter == 4500){
					pulse_counter = 0;
					delay_counter = 0;
					num_pulse ++;
					if (num_pulse == 36){
						num_pulse = 1;
						adc_val = 0;
						once_off_delay = 0;
					}
				}
			}
			
			else {delay_counter ++;}
		}
		else {once_off_delay ++;}
	}
	
	else {
		adc_val = HAL_ADC_GetValue(&hadc1);
		HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12, 0);
	}

}
/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @param  file: The file name as string.
  * @param  line: The line in file as a number.
  * @retval None
  */
void _Error_Handler(char *file, int line)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  while(1)
  {
  }
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t* file, uint32_t line)
{ 
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
     tex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */

/**
  * @}
  */

/**
  * @}
  */

/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/
